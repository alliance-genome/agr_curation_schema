id: https://github.com/alliance-genome/agr_curation_schema/src/schema/variation
name: Alliance-Schema-Prototype-Variation
title: Alliance Schema Prototype Variation

imports:
  - core
  - allele
  - linkml:types
  - ontologyTerm

prefixes:
  alliance: 'http://alliancegenome.org/'
  linkml: 'https://w3id.org/linkml/'
  PDBE: 'https://www.ebi.ac.uk/pdbe/entry/pdb/'
  RCSB_PDB: 'https://www.rcsb.org/structure/'
  WWPDB: 'https://www.rcsb.org/structure/'
  gff: 'https://w3id.org/gff'
  faldo: 'http://biohackathon.org/resource/faldo#'
  biolink: 'https://w3id.org/biolink/vocab/'
  NLMID: 'https://www.ncbi.nlm.nih.gov/nlmcatalog/?term='
  schema: 'http://schema.org/'
  dct: 'http://purl.org/dc/terms/'
  WIKIDATA_PROPERTY: 'https://www.wikidata.org/wiki/Property:'
  obograph: 'https://github.com/biodatamodels/obograph'

default_prefix: alliance
default_range: string

default_curi_maps:
  - obo_context
  - idot_context
  - semweb_context
  - monarch_context

emit_prefixes:
  - rdf
  - rdfs
  - xsd
  - owl


# Classes

classes:

  Variant:
    is_a: GenomicEntity
    description: >-
      A DNA, RNA or protein/polypeptide sequence that differs relative to a
      designated reference sequence.  The sequence occurs at a single
      position or in a range of contiguous nucleotides or amino acids.
    slots:
      - variant_type
      - related_notes
      - source_general_consequence
      - variant_genome_locations # assembly identifies a genome location, so a variant on many assemblies can have many genome locations.
      - variant_polypeptide_locations
      - variant_transcript_locations
      - source_variant_locations
      - variant_status
    exact_mappings:
      - SO:0001059
    rules:
      - postconditions:
          any_of:
            - slot_conditions:
                variant_genome_locations:
                  required: true
            - slot_conditions:
                variant_status:
                  equals_string: private
            - slot_conditions:
                variant_status:
                  equals_string: ambiguous
          description: a variant must have a genome location, or must be private

  SourceVariantLocation:
    is_a: AuditedObject
    description:
      Links a paper to the variant locations described in that paper
    slots:
      - variant_locations
      - single_reference
    slot_usage:
      single_reference:
        required: true

  VariantLocation:
    is_a: AuditedObject
    abstract: true
    description: >-
      Base class linking a variant to a position on a genomic entity and the resulting consequence to the sequence
      and/or function of that genomic entity. Slots are provided for data taken from a source publication or data
      load and for data resulting from manual curation. Where the values are the same, the curator has confirmed
      the information from the source.  In other cases, the curator's analysis has resulted in different values,
      for instance, if the assembly is different, the source did not specify the transcript or protein isoform,
      the definition of the transcript or protein isoform used by the source has changed, or if there was an error
      in the source data.
    slots:
      - evidence_code
      - single_reference
      - start_position
      - end_position
      - reference_sequence
      - variant_sequence
      - consequence
      - sequence_of_reference_accession_number

  VariantGenomeLocation:
    is_a: VariantLocation
    description: >-
      Links a variant to a genomic position and the resulting consequence to the sequence and/or function.
      In practice, functional consequences for variants which overlap genes are not generally provided at the
      genome level but rather are calculated and annotated relative to a specific transcript or protein isoform.
    slots:
      - assembly
      - chromosome
    slot_usage:
      assembly:
        required: true
      chromosome:
        required: true
      start_position:
        required: true
      end_position:
        required: true
      sequence_of_reference_accession_number:
        required: true

  VariantTranscriptLocation:
    is_a: VariantLocation
    description: >-
      Links a variant to a position on a specified transcript and the resulting consequence to the sequence and/or
      function of that transcript.
    slots:
      - transcript
    slot_usage:
      sequence_of_reference_accession_number:
        required: true

  VariantPolypeptideLocation:
    is_a: VariantLocation
    description: >-
      Links a variant to a position on a specified polypeptide and the resulting consequence to the sequence and/or
      function of that polypeptide.
    slots:
      - polypeptide
      - associated_transcripts
    slot_usage:
      sequence_of_reference_accession_number:
        required: true


# Slots

slots:

  variant_curie:
    range: string

  variant_status:
    description: >-
    required: false # should this default to "public?"
    range: variant_status_enum

  variant_type:
    description: >-
      SOTerm describing the type of variant. In practice, variant type will be limited to a subset of the SO specified
      in an Alliance controlled vocabulary in order to maintain consistency.
    required: true
    multivalued: false
    domain: Variant
    range: SOTerm

  source_general_consequence:
    aliases: ['transcript_consequence']
    description: >-
      SOTerm (child of SO:0001576 - transcript_variant) that describes the
      consequence of the variant, as stated in the source reference when no
      transcript ID is provided. Since a curator would determine variant location and consequences relative to at
      least one specific genome assembly, transcript and/or polypeptide, no slot for curated general consequence
      is provided.
    required: false
    multivalued: false
    domain: Variant
    range: SOTerm

  sequence_of_reference_accession_number:
    description: >-
      The accession number that describes the assembly and chromosome of the reference sequence.
    required: true
    multivalued: false
    domain: VariantLocation
    range: string

  consequence:
    description: >-
      SOTerm (child of SO:0001576 - transcript_variant) that describes the
      consequence of the variant, as stated in the source reference. In practice source consequence will be
      associated with locations at any or all of VariantGenomeLocation, VariantTranscriptLocation, and
      VariantPolypeptideLocation.
    required: false
    multivalued: false
    domain: VariantLocation
    range: SOTerm

  curated_consequence:
    description: >-
      SOTerm that describes the consequence of the variant, as determined by
      the curator. In practice curated consequence will be associated with locations at any or all of
      VariantGenomeLocation, VariantTranscriptLocation, and VariantPolypeptideLocation.
    required: false
    multivalued: false
    domain: VariantLocation
    range: SOTerm

  variant_locations:
    description: >-
      Location of the variant within genomic entities. Variant_locations can include any or all of: one
      VariantGenomeLocation stanza, one or more VariantTranscriptLocation stanzas and/or one or more
      VariantPolypeptideLocation stanzas.
    multivalued: true
    domain: Variant
    range: VariantLocation

  variant_genome_locations:
    is_a: variant_locations
    description: >-
      Location of the variant in a genomic context.  multiple variant_genome_locations represent multiple
      assemblies.  because we want the variant to stay consistent between assemblies, we must have a single 
      variant object apart from its location.
    required: true
    multivalued: true
    domain: Variant
    range: VariantGenomeLocation
    inlined: true
    inlined_as_list: true

  variant_polypeptide_locations:
    is_a: variant_locations
    description: >-
      Location of the variant within polypeptide entities.
    required: false
    multivalued: true
    domain: Variant
    range: VariantPolypeptideLocation

  variant_transcript_locations:
    is_a: variant_locations
    description: >-
      Location of the variant within transcript entities.
    required: false
    multivalued: true
    domain: Variant
    range: VariantTranscriptLocation

  source_variant_locations:
    description: >-
      Location of the variant within genomic entities, as described in the source
      references.
    required: false
    multivalued: true
    domain: Variant
    range: SourceVariantLocation

  hgvs:
    description: >-
      HGVS nomenclature for variant located on a genomic entity. In practice HGVS nomenclature will be derived
      for any or all of VariantGenomeLocation, VariantTranscriptLocation, and VariantPolypeptideLocation.
    required: true
    domain: VariantLocation
    range: string

  # May want to remove domain of following 8 slots and move them to core
  # so that they can be used for alignment of other genomic entities
  assembly:
    description: >-
      Assembly to which variant is aligned.
    multivalued: false
    required: false
    domain: VariantLocation
    range: Assembly

  chromosome:
    description: >-
      Chromosome to which variant is aligned.
    multivalued: false
    required: false
    domain: VariantLocation
    range: Chromosome

  start_position:
    description: >-
      Start position of variant on genomic entity.
    multivalued: false
    required: false
    domain: VariantLocation
    range: integer

  end_position:
    description: >-
      End position of variant on genomic entity.
    multivalued: false
    required: false
    domain: VariantLocation
    range: integer

  reference_sequence:
    description: >-
      Reference sequence of genome or genomic entity at position of aligned
      variant.
    multivalued: false
    required: false
    domain: VariantLocation
    range: biological_sequence

  variant_sequence:
    description: >-
      Sequence that differs from the reference sequence of genome or genomic entity at position of variant,
      as specified by curator.
    multivalued: false
    required: false
    domain: VariantLocation
    range: biological_sequence

  transcript:
    description: >-
      Transcript associated with variant and for which a specific location and consequence of that variant
      is provided, as specified at source.  Multivalued=false for this slot because although a variant can have
      multiple VariantTranscriptLocation stanzas, each stanza will have one and only one source transcript ID.
    required: false
    multivalued: false
    domain: VariantTranscriptLocation
    range: Transcript

  polypeptide:
    description: >-
      Transcript associated with variant and for which a specific location and consequence of that variant is
      provided, as specified by curator. Multivalued=false for this slot because although a variant can have
      multiple VariantTranscriptLocation stanzas, each stanza will have one and only one curated transcript ID.
    required: true
    multivalued: false
    domain: VariantTranscriptLocation
    range: Transcript

  associated_transcripts:
    description:
      Transcript(s) associated with polypeptide to which variant is aligned.
    required: false
    multivalued: true
    domain: VariantPolypeptideLocation
    range: Transcript

enums:
  variant_status_enum:
    permissible_values:
      public:
      private:
