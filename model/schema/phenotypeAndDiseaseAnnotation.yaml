id: https://github.com/alliance-genome/agr_persistent_schema/phenotypeAndDiseaseAnnotation.yaml
name: Alliance-Schema-Prototype-Phenotype-and-Disease-Annotation
title: Alliance Schema Prototype Phenotype and Disease Annotation
description: Alliance Phenotype and Disease Annotation Schema Prototype with LinkML

default_prefix: alliance
default_range: string

imports:
  - linkml:types
  - reference
  - core
  - gene
  - ontologyTerm


prefixes:
  alliance: 'http://alliancegenome.org/'
  linkml: 'https://w3id.org/linkml/'
  PDBE: 'https://www.ebi.ac.uk/pdbe/entry/pdb/'
  RCSB_PDB: 'https://www.rcsb.org/structure/'
  WWPDB: 'https://www.rcsb.org/structure/'
  gff: 'https://w3id.org/gff'
  faldo: 'http://biohackathon.org/resource/faldo#'
  biolink: 'https://w3id.org/biolink/vocab/'
  NLMID: 'https://www.ncbi.nlm.nih.gov/nlmcatalog/?term='
  schema: 'http://schema.org/'
  dct: 'http://purl.org/dc/terms/'
  WIKIDATA_PROPERTY: 'https://www.wikidata.org/wiki/Property:'
  obograph: 'https://github.com/biodatamodels/obograph'

default_curi_maps:
  - obo_context
  - idot_context
  - semweb_context
  - monarch_context

emit_prefixes:
  - rdf
  - rdfs
  - xsd
  - owl

## ------------
## CLASSES
## ------------

classes:

  PhenotypeAnnotation:
    is_a: Association
    description: >-
      An annotation asserting an association between a biological entity and a phenotype supported by evidence.
    slots:
      - curie
      - single_reference
      - phenotype_term                    # phenotypeTermIdentifiers in JSON schema
      - condition_relations
    slot_usage:
      subject:                            # objectId in JSON schema
        description: >-
          The biological entity (e.g. gene, allele, genotype) to which the phenotype is associated, by direct curation.
        required: true
        range: BiologicalEntity
      phenotype_term:
        values_from:
          - HP
          - MP
          - WBPhenotype
          - ZP
          - APO
          - FBcv
        range: PhenotypeTerm
        examples:
          - value: HP:0002487
            description: Hyperkinesis
          - value: WBPhenotype:0000180
            description: axon morphology variant
          - value: MP:0001569
            description: abnormal circulating bilirubin level
      object:             # phenotypeStatement in JSON schema; eventually object should point to Phenotype class object
        description: >-
          phenotype statement: The label of an individual phenotype term from a phenotype ontology or the post-composed
          statement of the phenotype from a post-composed terminology
        required: true
        range: string
      single_reference:
        description: >-
          The reference in which the phenotype association was asserted/reported.
      date_created:
        description: >-
          The date of curation at the source (MOD) database.
        required: true
        multivalued: false

  GenePhenotypeAnnotation:
    description: >-
      An annotation asserting an association between a gene and a phenotype
      supported by evidence.
    is_a: PhenotypeAnnotation
    slots:
      - sgd_strain_background   # Does this also apply to phenotype annotations?
    slot_usage:
      subject:
        required: true
        description: >-
          The gene to which the phenotype ontology term is associated.
        range: Gene
#      predicate:
#        description: The relationship between gene and phenotype.
#        required: true
#        range: gene_phenotype_relation_enum  # TO DO: generate this relation enumeration or don't specify predicate

  AllelePhenotypeAnnotation:
    description: >-
      An annotation asserting an association between an allele
      and a phenotype supported by evidence.
    is_a: PhenotypeAnnotation
    slots:
      - inferred_gene
      - asserted_genes
    slot_usage:
      subject:
        description: >-
          The allele to which the phenotype ontology term is associated.
        range: Allele
#      predicate:
#        description: The relationship between allele and phenotype.
#        range: allele_phenotype_relation_enum   # TO DO: generate this relation enumeration or don't specify predicate
#        required: true
      inferred_gene:
        description: >-
          The gene to which the phenotype is inferred to be associated.
        required: false
        range: Gene
      asserted_genes:
        required: false
      asserted_allele:
        required: false

  AGMPhenotypeAnnotation:
    description: >-
      An annotation asserting an association between an AGM and a phenotype
      supported by evidence.
    is_a: PhenotypeAnnotation
    slots:
      - inferred_allele
      - inferred_gene
      - asserted_genes
      - asserted_allele
    slot_usage:
      subject:
        description: >-
          The AGM to which the phenotype ontology term is associated.
        range: AffectedGenomicModel
#      predicate:
#        description: The relationship between AGM and phenotype.
#        range: agm_phenotype_relation_enum   # TO DO: generate this relation enumeration or don't specify predicate
#        required: true
      inferred_gene:
        description: >-
          The gene to which the phenotype is inferred to be associated.
        required: false
        range: Gene
      inferred_allele:
        description: >-
          The allele to which the phenotype is inferred to be associated.
        required: false
        range: Allele
      asserted_genes:
        required: false
      asserted_allele:
        required: false


  DiseaseAnnotation:
    is_a: Association
    abstract: true
    description: >-
      An annotation asserting an association between a biological entity and a disease supported by evidence.
    slots:
      - alliance_curie
      - unique_id
      - mod_entity_id
      - negated
      - evidence_codes
      - single_reference
      - annotation_type
      - with
      - disease_qualifiers
      - condition_relations
      - genetic_sex
      - related_notes
      - data_provider
      - secondary_data_provider
      - disease_genetic_modifier
      - disease_genetic_modifier_relation
    slot_usage:
      alliance_curie:
        description: >-
          The Alliance-minted ID for the disease annotation. The ID is of the format
          AGRKB:100000000000001, where the first three digits represent the
          DiseaseAnnotation class code of "100", followed by a 12-digit identifier
      unique_id:
        description: >-
          Unique identifer for the disease annotation.  Will be generated at AGR
          if not submitted by the MOD.
        required: false
      mod_entity_id:
        description: >-
          The model organism database (MOD) identifier/curie for the disease annotation. Currently only
          used by WormBase for disease annotations, e.g. "WBDOannot00000907"
      subject:
        required: true
        description: >-
          The biological entity to which the disease ontology term is associated.
        range: BiologicalEntity
      predicate:  # predicate is basically disease_relation.  We should determine if we want such a generic name for this in the parent Association object
        required: true
        description: >-
          Constrains the disease subject, associationType and inferredGeneAssociation.
      negated:
        description: >-
          The negative qualifier for the annotation.
      object:
        required: true
        description: >-
          The disease ontology term.
        range: DOTerm
      data_provider:
        required: true
      annotation_type:
        required: false
      with:
        description: >-
          A field for disease annotations that captures the human gene the
          implicated MOD gene is homologous or orthologous to when using the ISS (inferred
          from sequence similarity) evidence code or the ISO (inferred from sequence orthology)
          evidence code. The assertion would state that the MOD gene is implicated in the
          indicated disease based on sequence-similarity/sequence-orthology "with" some human
          gene. Currently used by SGD.
        required: false    # Required for SGD disease annotations using ISS or ISO evidence codes
      single_reference:               # evidence in JSON schema
        required: true
        description: >-
          The reference in which the disease association was asserted/reported.
      evidence_codes:
        multivalued: true
        required: true
      genetic_sex:
        description: >-
          Submitted value should be a vocabulary term from the 'Genetic sexes'
          vocabulary
        range: VocabularyTerm
        required: false
      related_notes:
        description: >-
          Valid note types are available for viewing in the A-Team curation tool
          Controlled Vocabulary Terms Table (in the "Disease annotation note types" vocabulary)
          on the production environment (curation.alliancegenome.org). New terms
          can be added as needed.

  GeneDiseaseAnnotation:
    description: >-
      An annotation asserting an association between a gene and a disease
      supported by evidence.
    is_a: DiseaseAnnotation
    slots:
      - sgd_strain_background
    slot_usage:
      subject:
        required: true
        description: >-
          The gene to which the disease ontology term is associated.
        range: Gene
      predicate:
        description: >-
          The relationship between gene and disease. Submitted value should be a
          vocabulary term from the 'Gene disease relations' vocabulary
        required: true
        range: VocabularyTerm

  AlleleDiseaseAnnotation:
    description: >-
      An annotation asserting an association between an allele
      and a disease supported by evidence.
    is_a: DiseaseAnnotation
    slots:
      - inferred_gene
      - asserted_genes
    slot_usage:
      subject:
        description: >-
          The allele to which the disease ontology term is associated.
        range: Allele
      predicate:
        description: >-
          The relationship between allele and disease. Submitted value should be
          a vocabulary term from the 'Allele disease relations' vocabulary
        range: VocabularyTerm
        required: true
      inferred_gene:
        description: >-
          The gene to which the disease is inferred to be associated.
        required: false
        range: Gene
      asserted_genes:
        required: false

  AGMDiseaseAnnotation:
    description: >-
      An annotation asserting an association between an AGM and a disease
      supported by evidence.
    is_a: DiseaseAnnotation
    slots:
      - inferred_allele
      - inferred_gene
      - asserted_genes
      - asserted_allele
    slot_usage:
      subject:
        description: >-
          The AGM to which the disease ontology term is associated.
        range: AffectedGenomicModel
      predicate:
        description: >-
          The relationship between AGM and disease. Submitted value should be a
          vocabulary term from the 'AGM disease relations' vocabulary
        range: VocabularyTerm
        required: true
      inferred_gene:
        description: >-
          The gene to which the disease is inferred to be associated.
        required: false
        range: Gene
      inferred_allele:
        description: >-
          The allele to which the disease is inferred to be associated.
        required: false
        range: Allele
      asserted_genes:
        required: false
      asserted_allele:
        required: false

  ExperimentalCondition:
    is_a: AuditedObject
    description: >-
      The environmental context in which an experiment is carried out. This may (e.g. drug treatment)
      or may not (e.g. standard conditions) directly influence the outcome of the experiment.
    slots:
      - unique_id                         # calculated centrally at the Alliance after import from MODs
      - condition_class                   # conditionClassId in frozen JSON schema
      - condition_summary                 # analagous to conditionStatement in frozen JSON schema; for new DQM submissions should not be submitted but rather calculated centrally at the Alliance
      - condition_statement               # conditionStatement in frozen JSON schema
      - condition_id                      # conditionId in frozen JSON schema
      - condition_free_text               # dedicated slot for free text
      - condition_quantity                # conditionQuantity in frozen JSON schema
      - condition_anatomy                 # anatomicalOntologyId in frozen JSON schema
      - condition_gene_ontology           # geneOntologyId in frozen JSON schema
      - condition_taxon                   # NCBITaxonId in frozen JSON schema
      - condition_chemical                # ChemicalOntologyId in frozen JSON schema
    slot_usage:
      unique_id:
        description: >-
          Unique identifer for the experimental condition.  Will be generated at
          AGR.
        required: false
      condition_class:
        description: >-
          The ZECO ID that represents the high level condition grouping term.  This will come from
          a slim in the ZECO, called 'AllianceSlim'.
      condition_statement:
        description: >-
          Free text describing the environmental/experimental condition. For some groups this is a
          single term, others is it is a concatenation of the term names from the ontologies included
          in this data structure. To be submitted by DQMs; eventually will be deprecated once DQMs no
          longer submit these ExperimentalCondition objects.
        range: string
      condition_summary:
        description: >-
          Free text describing the environmental/experimental condition. For some groups this is a
          single term, others is it is a concatenation of the term names from the ontologies included
          in this data structure. Similar to condition_statement except the condition_summary will not
          be submitted by DQMs but rather generated at the Alliance after ingest (or generated/updated
          in the curation interface and persistent store).
        range: string
      condition_id:
        description: >-
          The specific ontology ID for the condition when that is not covered by any of the other
          condition ontology ID attributes (chemical, NCBITaxon, anatomical). This could also be another
          ZECO term if the ZECO term that describes this condition is more specific, or outside the
          conditionClassId slim.
      condition_quantity:
        description: >-
          Optional free text field that records the units/amount/degrees of a condition.
        required: false
      condition_anatomy:
        description: >-
          Anatomical ontology identifier used in cases like regeneration/wounding.
      condition_gene_ontology:
        description: >-
          Gene Ontology id used in subset of condition types.
        range: GOTerm
      condition_taxon:
        description: >-
          NCBITaxon ontology id used in subset of condition types like 'bacterial infection'.
      condition_chemical:
        description: >-
          ChEBI or molecular ontology id used in subset of condition terms.  ie: the specific
          chemcial used in conjunction with 'chemical condition'.
        range: ChemicalTerm


  ConditionRelation:
    is_a: AuditedObject
    description: >-
      A pairing of an experimental condition relation (i.e. has_condition) with a list of 1 or more
      ExperimentalCondition objects. Annotation objects can connect directly to a set of 0 or more
      of these ConditionRelation objects via a 'condition_relations' slot to express the experimental
      conditions relevant to the annotation.
    slots:
      - unique_id
      - handle
      - single_reference
      - condition_relation_type
      - conditions
    slot_usage:
      unique_id:
        description: >-
          Unique identifer for the condition relation.  Will be generated at
          AGR.
        required: false
      handle:
        required: false
        multivalued: false
      single_reference:
        required: false
      condition_relation_type:
        required: true
        multivalued: false

## ------------
## SLOTS
## ------------

slots:

  condition_anatomy:
    domain: ExperimentalCondition
    range: AnatomicalTerm
    values_from:
      - UBERON
      - WBbt
      - ZFA
      - FBbt
      - GO

  condition_chemical:
    domain: ExperimentalCondition
    range: OntologyTerm                     # Update to Chemical if such a class is instantiated
    values_from:
      - CHEBI
      - WBMol

  condition_class:
    required: true
    domain: ExperimentalCondition
    range: ZECOTerm

  condition_gene_ontology:
    domain: ExperimentalCondition
    range: GOTerm                     # Update to GOTerm if such a class is instantiated

  condition_id:
    domain: ExperimentalCondition
    range: ExperimentalConditionOntologyTerm

  condition_quantity:
    domain: ExperimentalCondition
    range: string

  condition_statement:
    description: >-
      A human-readable summary of the experimental condition accounting for all ontology terms and free-text
      components of the ExperimentalCondition object. To be generated and submitted by DQMs
    required: true
    domain: ExperimentalCondition
    range: string

  condition_summary:
    description: >-
      A human-readable summary of the experimental condition accounting for all ontology terms and free-text
      components of the ExperimentalCondition object. Not generated or submitted by DQMs, but generated at the
      Alliance after ingest only (or generated/updated in the curation interface).
    required: false     # not required for DQM submission; otherwise required in the persistent store and downstream
    domain: ExperimentalCondition
    range: string

  condition_free_text:
    description: >-
      Free-text description of the experimental condition
    required: false
    domain: ExperimentalCondition
    range: string

  condition_taxon:
    domain: ExperimentalCondition
    range: NCBITaxonTerm

  condition_relations:
    range: ConditionRelation
    multivalued: true
    inlined: true
    inlined_as_list: true

  condition_relation_type:
    description: >-
      Submitted value should be a vocabulary term from the 'Condition relation
      types' vocabulary
    domain: ConditionRelation
    range: VocabularyTerm

  conditions:
    range: ExperimentalCondition
    multivalued: true
    inlined: true
    inlined_as_list: true

  inferred_gene:
    description: >-
      The gene to which something is inferred to be associated.
    range: Gene

  inferred_allele:
    description: >-
      The allele to which something is inferred to be associated.
    range: Allele

  asserted_genes:
    singular_name: asserted_gene
    description: >-
      The gene(s) to which something is manually asserted to be associated.
    range: Gene
    multivalued: true

  asserted_allele:
    description: >-
      The allele to which something is manually asserted to be associated.
    range: Allele

  disease_qualifiers:
    description: >-
      Submitted values should be vocabulary terms from the 'Disease Qualifiers'
      vocabulary
    domain: DiseaseAnnotation
    multivalued: true
    range: VocabularyTerm

  genetic_sex:
    description: >-
      Submitted value should be a vocabulary term from the 'Genetic sexes'
      vocabulary
    range: VocabularyTerm

  sgd_strain_background:
    range: AffectedGenomicModel

  annotation_type:
    range: VocabularyTerm
    description: >-
      The type of annotation classified according to curation method. Submitted
      value should be a vocabulary term from the 'Annotation types' vocabulary

  disease_genetic_modifier:
    description: >-
      Specifies a genetic object that modifies the disease model. May be a gene, allele, AGM.
    required: false

  disease_genetic_modifier_relation:
    description: >-
      A relation describing how the genetic modifier modifies the disease model.
      Submitted value should be a vocabulary term from the 'Disease genetic
      modifiers' vocabulary
    range: VocabularyTerm

  phenotype_term:
    range: PhenotypeTerm

  with:
    description: >-
      http://geneontology.org/docs/go-annotation-file-gaf-format-2.2/#with-or-from-column-8
    range: Gene
    multivalued: true

  handle:
    description: >-
      A slot pointing to a free-text alias or 'handle' for a data object, such as
      a reference-specific alias for a data object used while curating.
    range: string
