id: https://github.com/alliance-genome/agr_persistent_schema/phenotypeAndDiseaseAnnotation.yaml
name: Alliance-Schema-Prototype-Phenotype-and-Disease-Annotation
title: Alliance Schema Prototype Phenotype and Disease Annotation
description: Alliance Phenotype and Disease Annotation Schema Prototype with LinkML

default_prefix: alliance
default_range: string

default_curi_maps:
  - obo_context
  - idot_context
  - semweb_context
  - monarch_context

emit_prefixes:
  - rdf
  - rdfs
  - xsd
  - owl

imports:
  - linkml:types
  - reference
  - core
  - ontologyTerm


prefixes:
  alliance: 'http://alliancegenome.org'
  linkml: 'https://w3id.org/linkml/'


## ------------
## CLASSES
## ------------

classes:

  PhenotypeAnnotationCurated:
    is_a: Association
    mixins:
      - AuditedObject
    description: >-
      An annotation asserting an association between a biological entity and a phenotype supported by evidence.
    slots:
      - curie
      - phenotype_term                    # phenotypeTermIdentifiers in JSON schema
      - date_assigned                     # dateAssigned in JSON schema
    slot_usage:
      subject:                            # objectId in JSON schema
        description: >-
          The biological entity (e.g. gene, allele, genotype) to which the phenotype is associated, by direct curation.
        required: true
        range: BiologicalEntity
      phenotype_term:
        values_from:
          - HP
          - MP
          - WBPhenotype
          - ZP
          - APO
          - FBcv
        range: Phenotype
        examples:
          - value: HP:0002487
            description: Hyperkinesis
          - value: WBPhenotype:0000180
            description: axon morphology variant
          - value: MP:0001569
            description: abnormal circulating bilirubin level
      object:             # phenotypeStatement in JSON schema; eventually object should point to Phenotype class object
        description: >-
          phenotype statement: The label of an individual phenotype term from a phenotype ontology or the post-composed
          statement of the phenotype from a post-composed terminology
        required: true
        range: string
      references:
        required: true
        range: Reference
        multivalued: false
        description: >-
          The reference in which the phenotype association was asserted/reported.
      date_assigned:
        description: >-
          The date of curation at the source (MOD) database.
        required: true
        multivalued: false
        range: date

  PhenotypeAnnotationInferred:
    is_a: PhenotypeAnnotationCurated
    description: >-
      A curated phenotype annotation (see class PhenotypeAnnotationCurated) for which inferences have been made to apply 
      additional information such as inferred gene or inferred allele.
    slots:
      - inferred_gene
      - inferred_allele
    slot_usage:
      inferred_gene:
        description: >-
          The gene to which the phenotype is inferred to be associated.
        required: false
        range: Gene
      inferred_allele:
        description: >-
          The allele to which the phenotype is inferred to be associated.
        range: Allele
        required: false

  DiseaseAnnotationCurated:
    is_a: Association
    mixins:
      - AuditedObject
    description: >-
      An annotation asserting an association between a biological entity and a disease supported by evidence.
    slots:
      - curie
      - disease_relation        # objectRelation in JSON schema
      - negated                 # negation in JSON schema
      - data_provider           # dataProvider in JSON schema
      - with
      - evidence_code           # added to avoid the need for a publication join
      - date_assigned           # dateAssigned in JSON schema
    slot_usage:
      subject:                  # objectId in JSON schema
        required: true
        description: >-
          The biological entity to which the disease ontology term is associated.
        range: BiologicalEntity
      disease_relation:
        required: true
        description: >-
          Constrains the disease object, associationType and inferredGeneAssociation.
        range: disease_relation_enum
      negated:
        description: >-
          The negative qualifier for the annotation.
      object:                   # Disease; DOid in JSON schema
        required: true
        description: >-
          The disease ontology term.
        range: Disease
      data_provider:
        required: true
        description: >-
          source of data, can be multiple of these, each with a type and a crossReference
      with:
        description: >-
          http://geneontology.org/docs/go-annotation-file-gaf-format-21/#with-or-from-column-8
      references:               # evidence in JSON schema
        required: true
        multivalued: false
        description: >-
          The reference in which the disease association was asserted/reported.
      evidence_code:
        multivalued: true
      date_assigned:
        required: true
        description: >-
          Date this entity was assigned in its primary data source.
        range: date

  DiseaseAnnotationInferred:
    is_a: DiseaseAnnotationCurated
    description: >-
      A curated disease annotation (see class DiseaseAnnotationCurated) for which inferences have been made to apply 
      additional information such as inferred gene or inferred allele.
    slots:
      - inferred_gene
      - inferred_allele
    slot_usage:
      inferred_gene:
        description: >-
          The gene to which the disease is inferred to be associated.
        required: false
        range: Gene
      inferred_allele:
        description: >-
          The allele to which the disease is inferred to be associated.
        range: Allele
        required: false

  ExperimentalCondition:
    description: >-
      The environmental context in which an experiment is carried out. This may (e.g. drug treatment)
      or may not (e.g. standard conditions) directly influence the outcome of the experiment.
    slots:
      - curie
      - condition_class                   # conditionClassId in JSON schema
      - condition_statement               # conditionStatement in JSON schema
      - condition_id                      # conditionId in JSON schema
      - condition_quantity                # conditionQuantity in JSON schema
      - condition_anatomy                 # anatomicalOntologyId in JSON schema
      - condition_gene_ontology           # geneOntologyId in JSON schema
      - condition_taxon                   # NCBITaxonId in JSON schema
      - condition_chemical                # ChemicalOntologyId in JSON schema
    slot_usage:
      condition_class:
        required: true
        description: >-
          The ZECO ID that represents the high level condition grouping term.  This will come from
          a slim in the ZECO, called 'AllianceSlim'.
        values_from:
          - ZECO
        range: OntologyTerm
      condition_statement:
        required: true
        description: >-
          Free text describing the environmental/experimental condition. For some groups this is a
          single term, others is it is a concatenation of the term names from the ontologies included
          in this data structure.
        range: string
      condition_id:
        description: >-
          The specific ontology ID for the condition when that is not covered by any of the other
          condition ontology ID attributes (chemical, NCBITaxon, anatomical). This could also be another
          ZECO term if the ZECO term that describes this condition is more specific, or outside the
          conditionClassId slim.
        range: OntologyTerm
        values_from:
          - XCO
          - ZECO
      condition_quantity:
        description: >-
          Optional free text field that records the units/amount/degrees of a condition.
        required: false
      condition_anatomy:
        description: >-
          Anatomical ontology identifier used in cases like regeneration/wounding.
        range: OntologyTerm
        # TODO: add rest of anatomical ontology prefixes here
        values_from:
          - ZFA
          - FBbt
          - WBbt
      condition_gene_ontology:
        description: >-
          Gene Ontology id used in subset of condition types.
        range: OntologyTerm
      condition_taxon:
        description: >-
          NCBITaxon ontology id used in subset of condition types like 'bacterial infection'.
        range: OntologyTerm
        values_from:
          - NCBITaxon
      condition_chemical:
        description: >-
          ChEBI or molecular ontology id used in subset of condition terms.  ie: the specific
          chemcial used in conjunction with 'chemical condition'.
        range: OntologyTerm
        values_from:
          - CHEBI
          - WBMol

  Phenotype:
    description: >-
      A characteristic of an organism. This may or may not be expressed as a difference in
      comparison to a reference organism.
    slots:
      - curie
      - name
    values_from:
      - HP
      - MP
      - WBPhenotype
      - ZP
      - APO
      - FBcv
    id_prefixes:
      - HP
      - MP
      - WBPhenotype
      - ZP
      - APO
      - FBcv

  Disease:
    slots:
      - curie
      - name
    values_from:
      - DOID
    id_prefixes:
      - DOID

  PhenotypeAnnotationExperimentalConditionAssociation:
    is_a: Association
    description: >-
      A typed (predicate-specified) association between a phenotype annotation object
      and an experimental condition object
    defining_slots:
      - subject        # phenotype_annotation
      - object      # experimental_condition
      - predicate
    slot_usage:
      subject:
        range: PhenotypeAnnotationCurated
      object:
        range: ExperimentalCondition
      predicate:
        range: condition_relation_enum

  DiseaseAnnotationExperimentalConditionAssociation:
    is_a: Association
    description: >-
      A typed (predicate-specified) association between a disease annotation object
      and an experimental condition object
    defining_slots:
      - subject        # disease_annotation
      - object      # experimental_condition
      - predicate
    slot_usage:
      subject:
        range: DiseaseAnnotationCurated
      object:
        range: ExperimentalCondition
      predicate:
        range: condition_relation_enum

## ------------
## SLOTS
## ------------

slots:

  condition_anatomy:
    domain: ExperimentalCondition
    range: uriorcurie                     # Update to AnatomicalEntity if such a class is instantiated
    values_from:
      - UBERON
      - WBbt
      - ZFA
      - FBbt
      - GO

  condition_chemical:
    domain: ExperimentalCondition
    range: uriorcurie                     # Update to Chemical if such a class is instantiated
    values_from:
      - CHEBI
      - WBMol

  condition_class:
    domain: ExperimentalCondition
    range: uriorcurie

  condition_gene_ontology:
    domain: ExperimentalCondition
    range: uriorcurie                     # Update to GOTerm if such a class is instantiated
    values_from:
      - GO

  condition_id:
    domain: ExperimentalCondition
    range: uriorcurie

  condition_quantity:
    domain: ExperimentalCondition
    range: string

  condition_statement:
    domain: ExperimentalCondition
    range: string

  condition_taxon:
    domain: ExperimentalCondition
    range: uriorcurie                     # Update to Taxon if such a class is instantiated
    values_from:
      - NCBITaxon

  date_assigned:                  # same as 'date_produced' in core.yaml?
    range: date

  disease_relation:
    range: disease_relation_enum

  evidence_code:              # this slot has also been instantiated in the orthology.yaml
    range: uriorcurie
    values_from:
      - ECO

  inferred_gene:
    description: >-
      The gene to which something is inferred to be associated.
    range: Gene
    
  inferred_allele:
    description: >-
      The allele to which something is inferred to be associated.
    range: Allele

  phenotype_term:
    range: Phenotype

  with:
    description: >-
      http://geneontology.org/docs/go-annotation-file-gaf-format-21/#with-or-from-column-8

## ----------
## PREDICATES
## ----------

  has_condition:
    is_a: related_to
    symmetric: false
    domain: Entity
    range: ExperimentalCondition

  is_condition_in:
    is_a: related_to
    symmetric: false
    inverse: has_condition
    domain: ExperimentalCondition
    range: Entity

  induced_by:
    is_a: related_to
    symmetric: false
    domain: Entity
    range: ExperimentalCondition

  induces:
    is_a: related_to
    symmetric: false
    inverse: induced_by
    domain: ExperimentalCondition
    range: Entity

  ameliorated_by:
    is_a: related_to
    symmetric: false
    domain: Entity
    range: ExperimentalCondition

  ameliorates:
    is_a: related_to
    symmetric: false
    inverse: ameliorated_by    
    domain: ExperimentalCondition
    range: Entity

  exacerbated_by:
    is_a: related_to
    symmetric: false
    domain: Entity
    range: ExperimentalCondition

  exacerbates:
    is_a: related_to
    symmetric: false
    inverse: exacerbated_by    
    domain: ExperimentalCondition
    range: Entity

## ------------
## ENUMS
## ------------

enums:

  condition_relation_enum:
    permissible_values:
      has_condition:
      induced_by:
      ameliorated_by:
      exacerbated_by:

  disease_relation_enum:
    permissible_values:
      is_model_of:
      is_implicated_in:
      is_marker_for:
      implicated_via_orthology:             # this would not be manually assigned but computationally
      biomarker_via_orthology:              # this would not be manually assigned but computationally


